# ERP记录的基本原理

## 干净数据的重要性

​		为什么要尽可能确保数据干净？因为你需要获得可重复的、具有统计显著性的实验效应。然而，除非你的ERP波形噪音水平很低，否则你不可能获得统计显著性的结果。背景EEG淹没了单试次中的ERP，但是通过信号的迭加平均，可以把ERP从EEG背景噪声中分离出来。因为用于迭加平均的试次越多，其结果中残留的EEG噪声就越少，所以获得干净数据的关键在于，确保ERP迭加平均中包含足够多的试次数目。然而噪声的减低，与迭加试次的平方根成正比。增加一倍减少30%，增加四倍噪音才能降低50%。

​		显然，你不能不断地将试次迭加四倍，不然实验就会变得太长。所以增加试次数目只是解决噪声问题的一个办法。另一个办法是在噪声通过电极被采集之前就把它去除。大部分ERP记录中的噪声并不是来源于EEG，而是源于其他生物信号，例如皮肤电位，以及EEG记录时偶然采集到的环境电噪音，这些噪声源通常可以被直接去除。当你花费几天时间来查找并去除这些噪声源将会对你ERP信号有很大改善。

## 活动电极和参考电极

### 电压是两点之间的电位

​		EEG放大系统使用了差动放大器，一个差动放大器使用三个电极来记录电活动：活动电极(A,active electrode)放在指定头皮位置，参考电极(R,reference electorde)放在其他头皮位置，接地电极(G)放在被试头部或者身上的某个适宜位置。这个差动放大器放大的是AG与RG之间的电压差。对于AG和RG，由于因放大器接地回路引起的环境电活动是相等的，因此AG与RG的相减算法将把环境电活动减去。

<img src="images\image-20221105194343194.png" alt="image-20221105194343194" style="zoom:67%;" />

​		最初，研究者假设活动电极位于活动脑组织附近，而参考电极位于一个比较源的电中性点。当活动电极附近的电活动发生变化，研究者假设这会改变活动点的电压，但是对参考点没有影响。当从若干个活动位点记录信号时，通常使用同一个参考电极。例如，你可以在额、顶和枕区的活动位点放置电极，并且使用一个耳垂电极作为所有活动电极的参考。

​		但是，在头上并不存在一个电中性的点，活动点和所谓参考点之间记录的电压将同时反映两个位点的活动。事实上，你要明白**ERP波形反映的是两点间的活动差异，而非单个点的活动**

### 参考点的选择

​		首先要明白，并不存在真正中性的位点，那么最合适作为参考的位点是什么呢？给出以下三点建议

+ 选择一个方便舒适的位点。举个反例，在鼻尖上放置电极会使人烦乱。

+ 避免使用一个偏向于某侧脑半球的参考点。例如，如果你用左耳垂作为参考，那么从左半球记录到的电压将与那些从右半球电极记录到的电压有所不同。你应该避免这种偏向。

+ 在你所有实验中使用相同的参考点，并且使用其他研究者常用的参考点。

  ​		认知神经科学中最常用的参考点是耳垂或者乳突（位于耳朵后面的突起小骨的位置）。一般使用乳突更多，因为乳突更容易得到好的电导通性，而耳垂夹式电极在使用超过1小时后被试会感到不太舒服。

  ​		耳朵和乳突都不满足第二个标准，因为你必须挑选头部某一侧，这导致了半球活动电极之间的不平衡。避免这种偏向的一个简单方法是**在左乳突(Lm, left mastoid)和右乳突(Rm,right mastoid)都安放电极,然后将Lm和Rm用导线物理连接起来。这称为连接乳突参考(linked mastoids reference)。然而这种方法会在两个半球间产生一个零阻抗电桥。这将导致头皮表面电压分布失真，并降低ERP的半球不对称性。为了避免这种问题，可以使用平均乳突参考推导。

![image-20221106105932305](images\image-20221106105932305.png)

​		换句话说，对于一个给定电位，你只需要减去另一个乳突记录电压的一半，就可以计算这个位点相对于平均乳突参考的电压了。这种方法同样适用于耳垂，综合考虑这是大多数ERP实验最好的参考电极方法。

## 环境中的电噪声

​		一个导体内的振荡电压将引起附近导体产生小的振荡电压，这就是为什么EEG中会显现环境噪声。在一个典型的ERP实验室中，存在两个主要的振荡电压源。即交变线路电路(AC line current)和视频显示器，交变线路电流由60Hz的正弦振荡组成，这将导致EEG记录中出现60Hz的线路噪声(line noise)。显示器产生的噪声常常是尖形的，而非正弦的。来源于视频显示器的噪声特别成问题，这是因为刺激与视频刷新同步，从而每个试次的噪声波形都相同，不能通过迭加平均处理。

​		最常用的方法是利用放大器的滤波来削弱噪声，大多数认知实验所关心的ERP主要是由30Hz以下的频段组成，因此你可以滤除所有所有超过30Hz的活动但却不会削弱太多ERP信号。并且，许多放大器都有一个线路滤波器(line filter)专门滤除50Hz或者60Hz的噪声。然而，滤波是一种可操作的失真变换，应尽量减少使用，所以仅仅滤波本身并不是最好的控制噪声的方法。

​		电屏蔽室

![image-20221106135041093](images\image-20221106135041093.png)

​		我们有一个非常容易的方法来检查类似这样的电噪声源。

![image-20221106135249574](images\image-20221106135249574.png)

​		可以用三个电阻器制作一个模拟头，把它连接到放大器和数字化系统，你就能看到当时记录室内不同位置的噪声有多大。首先，把模拟头放在被试坐的地方，并将它连接到放大器和数字化系统，系统设置为高增益（50000-100000），高采样率（例如，1000Hz），宽带通（例如，0.01——300Hz）。你将看到EEG显示出清晰的电噪声迹象（包括一个正弦线路频率振荡）。然后，关闭记录室内或者附近的的所有电设备，这将使EEG显示信号变得干净很多（即，呈现一条接近平直的线）。

### 电极和阻抗

​		从本质上来说，头皮电极只是一种附着于导线的导电材料，在大多数情况下，电极是一个金属盘，可以通过导电膏和导电材料，电极的选择非常重要，因为一些金属会很快腐蚀并失去电导性。此外，由皮肤、导电膏和电极所形成的回路就像一个电容器，会削弱低频信号（即，慢的电压变化）的传导。

​		从技术上来说，术语电阻仅适用于直流电的阻碍。当电压随着时间而改变时，电感或电容也会像电阻一样阻碍电流；所有对于电流的阻碍统称为阻抗。因此术语“阻抗”比“电阻”更为合适。阻抗常常用字母Z来标识。

#### 电极名称和放置常规

10/20系统

![image-20221106145635963](images\image-20221106145635963.png)

​		这个系统的第一步是要定义一个赤道，它通过鼻根（位于鼻子上方的两眼之间的凹陷点，标记为Nz），枕骨隆突（头后部的隆起位点，标记为Lz）和左右耳前点（紧靠中部耳翼前面的凹陷点，标记为A1和A2）。然后在lz和Nz之间画一条经线，再将这条经线划分为占总长10%的等分。然后在这些10%的位点加上一些与赤道同轴的维线。接下来就可以把大多数电极放置在沿着这些维线的10%或者20%的整数倍位点上。违反这种规则的电极是F3和F4（位于Fz和F7或F8之间的中点），以及P3和P4（位于Pz和T5或T6的中点）。

​		每个电极名称的开头用一两个字母来表示大的电极区域（Fp=额极(frontal pole)；F=额(frontal)；C=中央(central)；P=顶(parietal)；以及T=颞(temporal)）。电极名称结尾用一个数字或字母来表示与中心的距离，左半球为奇数，右半球为偶数。数字越大表示距离中线越远，中线位置用z来代表0（zero，因为0与o太像）。

​		大多数研究者都知道降低阻抗对于干净信号的获得很重要，但是很多人不了解高阻抗所造成问题的确切本质。高阻抗可以引起两种注意问题(1).降低共模抑制(commom-mode rejection)，(2).提高皮肤电位

​		首先先讨论共模抑制，EEG放大是通过差动放大器放大AG-RG来实现的。这种方法去除了存在于放大器接地回路中的电噪声于活动电极和参考电极上的其他任何等同电噪声，这对于获得干净的EEG记录是必要的。但若两个信号中的任何一个被轻微削弱噪声就不能完全去除。**放大器精确去除环境噪音的性能被称为共模抑制**，一个好的EEG放大器共模抑制至少为70dB，最好在100dB以上。当阻抗很高时共模抑制的有效性就会下降；当活动、参考和接地电极阻抗普遍很高，并且不同电极之间阻抗差异很大时，共模抑制将变得非常差。因此低阻抗将帮助你避免采集到环境噪声。

​		共模抑制不仅依赖于电极阻抗，而且依赖于放大器的输入阻抗。具有高输入阻抗的放大器可以允许较高的电极阻抗，从而使共模抑制依然保持在良好水平。然而，高放大器阻抗并不能解决高电极阻抗所带来的第二个问题，即**皮肤电位**

​		在皮肤表面和皮肤深层之间存在一个持续性电压，一旦皮肤阻抗发生改变，这个电压也会发生改变。因为这种电压通常很大，所以它们会成为EEG记录中低频噪声主要来源。而降低皮肤阻抗将显著减少皮肤电位。

## 信号的放大、过滤和数字化

### 模数转化和高通滤波器

​		一个被称为模数转换器(ADC,analog-to-digital converter)的设备将EEG电压波动转换为数字代码。ADC的分辨率是重要的性能指标，如果分辨率为12位表示可以编码2^12=4096个不同的电压值。你应该保证你的电压范围不要超出其编码范围，一般情况下，超出范围的负向电压将被编码为0，正向被编码为最大值。

​		有两个设置将会影响你是否可能超出ADC范围，第一个因素是增益，提高增益，EEG超出ADC范围的几率也会随之提高，但注意太低会导致分辨率受损。第二个因素是高通滤波的设置，高通滤波用来削减那些由皮肤电位引起的、大而缓慢的电压飘移。即使你使用低阻抗记录，一些皮肤电位仍然会出现，这些电位会使EEG飘移出ADC和放大器范围，导致平顶(flatline signal)信号。

### 离散的EEG采样和低通滤波

​		在一系列被称为样本的离散时间点上，EEG信号被转换成一串电压值。采样周期(sampling period)是指相邻两个样本之间的时间，采样率(sampling rate)是指每秒采集的样本数目(200Hz)。Nyquist Theorem指出，只要采样率为信号最高频率的两倍以上，EEG等模拟信号的所有信息就都可以被数字化提取。这个定理还指出，低采样率不仅会使你丢失信息，而且会引起数字化数据中的低频伪迹（又称混叠，aliasing)。

​		EEG放大器包括了低通滤波器，可以消减高频信号而使低频信号通过，你的采样率主要依赖于你所选择的低通滤波的截止频率。但100Hz的截止频率并没有完全抑制100Hz以上的东西。所以你应该利用滤波器截止频率的至少3倍作为数字化频率，例如80Hz滤波和250Hz数字化。

​		那么该如何确定截止频率？一般来说，低通滤波频率越高、失真越少，因而最好选择一个相当高的截止频率。但这样会要求非常高的数字化频率，导致文件很大。目前折中方法是低通截止频率设置为30到100Hz，采样率设置为100到300Hz。如果你在观察早期的感觉反应，需要设置为以上范围的高端，如果只是在观察地频，那么设置低端就可。请牢记，滤波频率和采样频率设置越低，你所得的时间精度也将越低。

### 放大器增益和标准化

​		来自于每个电极的信号都是由独立的EEG导联放大的。你所使用的增益（放大倍数）依赖于模数转换器的输入范围。例如，如果模数转换器允许的输入范围为-5V至+5V，那么你应该设置放大器增益，使其最极端的可能输入值接近-5V/+5V。即你应该使用模数转化器的整个范围，否则你就没有充分利用到它的分辨率。

​		![image-20221107111426589](images\image-20221107111426589.png)