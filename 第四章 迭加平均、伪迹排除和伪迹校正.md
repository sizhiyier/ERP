# 迭加平均、伪迹排除和伪迹校正

​		ERP通常淹没在更大的EEG信号中，几乎所有的ERP研究都依赖某种迭加平均方法来使EEG噪声最小化。

## 迭加平均过程

### 信号迭加平均原理

<img src="images\image-20221110215408820.png" alt="image-20221110215408820" style="zoom:67%;" />

​		如图说明了信号迭加平均的传统方法。首先，将刺激后的EEG的epoch从EEG中提取出来，然后按照时间锁定事件将这些EEG分段排列，再以点对点的方式进行迭加平均。

​		这背后逻辑如下：单试次所采集的EEG被认为是由ERP波形加上随机噪声所组成的。假定ERP波形对于每个试次都是相同的，而噪声却与时间锁定事件完全无关。每个试次的ERP是相同的，而噪声在试次间是随机的，大量试次的平均将得到一条直线。因此你把大量包含相同ERP波形和随机噪声的试次迭加平均在一起时，噪声就会减少，但ERP波形不变。

​		R表示单试次的噪音量，N表示试次数目，那么N个试次迭加平均波形的噪音量就等于(1/√N)*R。所以信噪比(S/N)的增加将与迭加次数的平方根成正比。

### 潜伏期变异带来的问题

<img src="images\image-20221111102557558.png" alt="image-20221111102557558" style="zoom:67%;" />

​		虽然不同试次之间的ERP振幅变异通常不会带来问题，但是潜伏期变异有时却会是一个很大的问题，如图显示了4个单独的试次，类似P3的ERP成分出现在不同的潜伏期。这些试次的平均波形的峰振幅要比单试次的峰振幅小得多。

<img src="images\image-20221111103109369.png" alt="image-20221111103109369" style="zoom:67%;" />

​		如B所示，当试次之间的潜伏期变异减小，使得平均波形的峰振幅变大。因此，如果两个实验条件或者两组被试的某个ERP成分的潜伏期变异程度不同，那么对于这个ERP成分，即使单试次的振幅完全相同，不同实验条件或者被试组的迭加平均波形看上去可能也有差别。

<img src="images\image-20221111104419273.png" alt="image-20221111104419273" style="zoom:67%;" />

​		更糟糕的是，潜伏期变异有时会导致在迭加平均波形中看不到某个特定的神经活动，如C所示。假设有一个正弦振荡，它是由刺激触发的，但其相位确实随机变化，这样的反应迭加平均为0。

<img src="images\image-20221111105740943.png" alt="image-20221111105740943" style="zoom:67%;" />

​		并行搜索：被试搜索一个具有独特视觉特征的靶，它可以从刺激呈现中突现出来，无论刺激阵列中有多少个干扰项目，靶都会被立即检测到。

​		串行搜索：靶的定义缺乏上述那样的特征，我们预期在这种情况下，被试会每次搜索一个项目直到找到靶。

​		因此我们预测在串行搜索情况下反应时会随着阵列数目的增加而延长，但在并行搜索情况下却不存在这种阵列项目效应。我们得到的结果也正如此。图B显示了这个实验的迭加平均ERP波形。在并行搜索的情况下，P3波的振幅更大，持续时间更短，而且不会随着阵列项目数不同而变化太大。在串行搜索下，P3的振幅较小但波形更宽。如果你测量串行搜索P3波峰处的振幅和潜伏期，你可能会推断，阵列数目对P3不会产生太大的影响，然而事实上(C)，在串行搜索的情况下，P3的振幅和潜伏期都显著受到了阵列项目数的影响，尽管这些效应被潜伏期的变异掩盖了。

​		下面就介绍一些技术，可以用来尽可能减少潜伏期变异所带来的影响。

#### 面积测量

​		若干试次的迭加平均曲线下的面积总是等于各个试次曲线下面积的平均，因而面积测量将完全不受潜伏期变异的影响。测量曲线下面积，找到把这个面积分为两个相等部分的时刻点（称为50%面积潜伏期测量 50percent area latency measure）。把这种测了吗应用于B图，可以发现阵列项目数对P3潜伏期的效应几乎与其对反应时的效应相同，第六章将详细讨论这种方法。

<img src="images\image-20221111104419273.png" alt="image-20221111104419273" style="zoom:67%;" />

​		使用这种方法有两个注意事项，第一，只有当面积测量所使用的潜伏期范围跨越了这个成分的整个潜伏期范围时，单试次面积平均和迭加平均的面积才是相等的。如果存在多个相互重叠的ERP成分，并且这些成分在不同条件下有差别，就必须使用相对窄的时间窗。第二，面积测量可能会曲解多相成分（即，同时具有正向和负向部分的成分）。如C,当潜伏期存在变异时，多相波形的正向和负向可能抵消。

#### 反应锁定的迭加平均

​		有些情况下，ERP成分的潜伏期变异与反应时变化相关，此时就可以利用反应锁定的迭加平均而不是刺激锁定的迭加平均。在反应锁定的迭加平均里，是反应而不是刺激，被用在迭加平均过程中对准排列单试次的EEG分段。

#### Woody滤波

​		估计目标成分在单试次中的潜伏期，并利用这个潜伏期作为迭加平均的时间锁定点。通过寻找单试次波形中与ERP成分模板最匹配的部分，可以在单个试次中将这个成分识别出来。这个技术最大困难在于单试次中识别目标成分，我感觉有点不太靠谱。

#### 时间锁定的频谱平均

​		提取特定振荡反应的方法，这类振荡反应具有相对于时间锁定随机变化的相位（起始时间），测量单试次振荡的振幅依赖于傅里叶变换，这在第五章里将详细讨论。傅里叶变换将一条波形转换为一系列具有不同频率、相位和振幅的正弦波。例如，如果你在一个1秒的EEG分段中应用傅里叶变换，你就能得到在任何频率的获得强度。这样，你可以对单试次计算每一个频率的振幅，然后你可以将这些振幅在不同试次平均。并且，因为振幅测量是独立于相位的，所以如果振荡相位在在不同试次间变化也没有关系。

### 来自前后刺激的重叠

​		为什么迭加刺激前后的ERP会引起失真？若在当前刺激的基线期间，对于前一个刺激的反应还没有结束；或者，在当前刺激的ERP反应终止前，下一个刺激就出现了。当刺激快速呈现时，这个问题会更更加严重。另外，erp波形可以持续好几秒，即使在较长的刺激间隔下，重叠也会使你的数据显著失真。

![image-20221112165702524](images\image-20221112165702524.png)

​		如图阐明了一个假象实验中的重叠问题，在这个实验里，刺激每隔300-500ms出现。A显示了一个给定刺激所诱发的没有任何重叠的真实波形。注意，刺激出现前波形是平直的，并且在刺激后1000ms时波形降为0。B显示了同样的刺激在遭遇当前刺激300、400或500ms出现时所诱发的波形；它们就是把原始波形向左移动了不同的时间段。C显示了由大量先前刺激所诱发波形的迭加平均，这些先前刺激随机等概率地出现于当前刺激前300到500ms。D显示了在300、400或500ms时出现的后继刺激所诱发的反应。E显示了在当前刺激呈现后300-500ms随机出现的刺激所产生的重叠。

​		在这个假象实验中，时间的抖动导致重叠刺激所诱发的平均波形变得模糊。即，在重叠波形中，早期原始波相对尖锐的正峰和负峰大多被削弱了。刺激之间的时间抖动效应相当于滤除原始波中的高频成分。随着刺激之间延迟范围变得越来越宽，抖动削弱的重叠成分的频率会越来越低。

​		F显示了原始波形和重叠波形之和，这个波形由于重叠而引起的失真相当严重 。第一，刺激前基线完全失真，这会导致初始正向成分看上去比实际大的多（比较F中的第一个正向成分以及A中的原始波形）。第二，第一个正向成分看上去开始于时间0点之前（一旦出现这种情况，总是可以提示我们有差错发生）。第三，存在一个完全错误的晚正峰。

+ 仔细思考重叠的确切模式是什么样的，以及不同条件下的重叠模式会有怎样的不同。
+ 使用尽量宽的刺激间延迟时间范围。如G，如果将抖动扩大为300-1000ms。
+ 利用高通滤波滤除。
+ 在实验设计中允许直接测量并减去重叠。例如，实验中可以包含一些不呈现刺激的小概率试次，并且生成相对于刺激在正常情况下应该出现的时刻点锁定迭加平均波形。这些波形仅包含了重叠，这些重叠波形可以从那些包含了重叠和真实刺激反应的波形中减去。
+ 估计已采集的数据的重叠，并且从迭加平均波形中减去这个估计重叠。

### 瞬时和稳态ERP

![image-20221113105222387](images\image-20221113105222387.png)

​		如果刺激是以固定的、而非变化的频率呈现，来自前后刺激的重叠会完全显现在迭加平均ERP波形中。事实上，先前和后继刺激对于当前刺激是完全时间锁定的，这意味着它们会在迭加平均波形中表现出来。因此，除非刺激间隔非常长，大多数认知ERP实验都在刺激间隔中使用抖动。

​		不过有时候却可以利用重叠这一特点。特别是，如果一系列相同的刺激以快速、有规律的频率呈现时，系统将停止产生复杂的瞬时反应，而进入一种稳态，此时系统以刺激的频率（及其整数倍）共振。稳态看上去像是两条正弦波之和，一条频率为刺激频率，另一条为双倍刺激频率。

​		左上角显示了当前视觉刺激的出现-消失频率为每秒两个周期时所得到的瞬态反应。当刺激频率为6Hz时，仍然有一些明显的峰，当增加到12直到20Hz时，反应主要为一条正弦波。

​		这种稳态反应可以概括为4个数值，分别为两条正弦波的振幅（大小）和相位（时间偏移）。与每个时刻点上都有个单独振幅的复杂瞬时反应相比，稳态反应要简单多。因此，稳态ERP被广泛用于感觉系统的研究和感觉疾病的诊断。

​		此外，稳态ERP还有个明显的缺点，即缺少了瞬时ERP的高时间分辨率。假设一个刺激150ms呈现一次，那么在一个刺激130ms时测量到的振幅包含了以下成分之和：当前刺激130ms、上个刺激280ms、上上个刺激430ms。

## 伪迹排除和校正

​		污染EEG记录的伪迹有几个类型，包括眨眼、眼动、肌肉活动和皮肤电位。这些伪迹会造成两个问题，第一，相比EEG伪迹通常很大，所以会降低信噪比。第二，某些类型的伪迹不是随机的而是系统性的，而且在一定程度上是与刺激时间锁定的，所以迭加平均不能消除这些伪迹。

​		伪迹排除，在单试次的EEG分段中就检测到大的伪迹，并简单的将这些被污染了的试次从迭加平均波形中排除。伪迹校正(artifact correction)，估计伪迹对ERP的影响，并利用校正程序来减去这些估计的伪迹成分。

### 伪迹排除的一般过程

+ 击中 hit 目标存在，超过阈值，做出反应
+ 漏报 miss 目标存在，未超出阈值，无反应
+ 虚报 false alarm 目标不存在，因随机噪声导致信号超出阈值，做出反应
+ 正确拒绝 correct rejection 目标不存在，信号未超出阈值，没有反应

### 选择伪迹测量方法

​		许多软件系统通过测量给定试次的EOG信号最大值，并排除那些最大值超出阈值的试次，来评估眨眼。但EOG导联的峰振幅是一种很差的眨眼伪迹测量方法，因为基线电压的变化会使EOG信号远离零值，以至于小噪声偏离有时就可能会导致电压超出阈值，引起虚报。基线电压的变化还可能引起EOG信号远离阈值，以至于真实的眨眼不再超出阈值，导致漏报。

![image-20221113144851897](images\image-20221113144851897.png)

​		A显示了当包含眨眼的EOG记录超出75μV阈值时会被排除，B显示了一条非常显眼的眨眼片段，但因为基线偏移了，所以漏报，C被虚报。

​		另一种方法是，测量EOG片段内的最大值与最小值的差异，并将这个峰——峰电压与阈值电压相比较。这种峰——峰测量不太容易被基线电压缓慢变化所扭曲，由此降低了这种漏报和虚报可能来源所带来的影响，并提高了伪迹校正处理的敏感性。

​		最敏感测量的选择依赖于你所测量的伪迹类型。例如，尽管峰——峰振幅可以敏感地测量眨眼，但他不是测量α波是否存在的敏感方法。良好的伪迹排除系统应该为不同类型的伪迹提供不同的测量方法。

### 选择排伪阈值

​		一般会基于经验挑选一个阈值，并且将该值应用于所有被试，但不同被试间常常有显著性差异，通常最好对每个被试定制一套伪迹排除处理

![image-20221113151300723](images\image-20221113151300723.png)

​		如果对于每个被试都设置单独的阈值，这种设置通常要基于对部分原始EEG的视觉检测。首先，对于一个给定被试，设置一个初始阈值作为起始点（根据经验），然后将这些阈值应用于一系列单独试次，并视觉评估那些具有真实伪迹的试次是否未被排除，或那些没有真实伪迹的试次被排除了。当然，这需要你能够通过视觉观测来判断是否存在真实伪迹。在大多数情况下，这很直观。在一些数据中使用初始阈值进行试验之后，阈值可以得到校正并用来进行再次检测，直至在并未排除太多无伪迹试次的同时，排除了所有的具有明显伪迹的试次（用视觉评估）。

​		在实验开始时候要求被试进行一些眨眼或者眼动，这样你可以很容易看到被试的伪迹看上去是什么样子。

### 检查和排除特殊类型的伪迹

#### 眨眼

![image-20221113155430987](images\image-20221113155430987.png)

​		在每只眼睛内，眼球正面有一个正向电位梯度，背面有一个负向电位梯度。在眼睛附近记录到的电压偏移，其主要原因是横越眼球表面的眼睑运动，它改变了眼球电位梯度在邻近区域的传导。眨眼反应主要是由大小50-100μV、持续200-400ms的单相位偏移组成。不过眨眼反应最显著特征在于，眼睛上方和下方部位的电位极性相反（例如图中VEGO和Fz的记录），这使得有可能区分眨眼和真实的EEG偏移，前者会在眼睛上下方产生极性相反的电压，而后者一般在眼睛上下方产生极性相同的电压。图中右侧显示了一个真实的EEG偏移，在VEOG和Fz位点上偏移的极性相似。

​		因为眨眼所表现出的极性翻转，你应该对那些在眼睛上下方电极具有相反极性的实验效应保持高度警惕，尽管真实的ERO效应也可能表现这样，但它可以作为提示ERP波形可能受到眨眼污染的信号。

​		可以使用1-2分钟的额短区组，这样为被试提供了频繁的休息间断，被试者可在休息时眨眼，同时也有助保持被试对任务的注意警觉程度。将5-6分钟的大区组划分为1-2分钟的小区组，在小区组之间插入20-30秒的间隔，而大区组的间隔应该更长。

#### 眼动

​		与眨眼一样，眼动也是眼睛固有电压梯度的结果。眼睛可以被看做一个偶极子，其正极指向眼球正面。眼睛运动指向的部位变得更正。例如，向左的眼动导致头皮左侧产生正向电压偏移，右侧产生负向电压偏移。

<img src="images\image-20221114183338114.png" alt="image-20221114183338114" style="zoom:67%;" />

​		除非被试正在观看移动的物体，或者产生缓慢的头动，大多数眼动将会是眼跳，即眼睛迅速发生弹道式转移。在没有噪声时，眼跳的组成包括，从零电压水平迅速变成非零电压水平，之后由于放大器的高通滤波又逐渐恢复到零。

#### 慢电压飘移

​		通常是由于皮肤电阻或电极电阻的变化而引起的（如4.9中的皮肤电位），E=IR，如果只电阻又不改变电流，电压也会跟着改变。而被试即使轻微出汗就会引起阻抗下降，由此所导致的慢电压飘移就被称为皮肤电位。降低皮肤电位最好的方法就是降低皮肤阻抗。

​		电极位置的轻微移动也会引起电压飘移，出现这种情况通常是由于被试在运动。电极位置的变化常常会引起阻抗变化，因此导致电压发生很大飘移。

​		当缓慢电压飘移较小时，一般不必把含有缓慢电压飘移的试次排除。如果电压飘移是随机的，那么迭加平均后可以消除，然而，电极位移有时候会导致电压突然变化，这时可以在每个导联应用峰—峰振幅函数或者阶梯函数检测。

#### 放大器饱和

​		缓慢电压飘移有时可能会引起放大器或ADC饱和，这导致EEG在一段时间内变得平直（这也被称为阻塞blocking）。如果经常发生这种情况，你应该降低放大器增益。

#### α波

​		α波是10Hz左右的EEG振荡，被试疲劳时出现最频繁。一般没有必要排除。

#### 肌肉和心脏活动

​		肌电EMG的频率非常高，大部分可以用放大器低通滤波去除。在实验时让被试放松，准备舒服椅子等。

​		心脏跳动EKG也可能在一些被试的EEG记录中观察到，很难开展这种伪迹的产生，而且这种伪迹通常以大约每秒1出的频率在整个记录期间都发生，所以排除EKG偏移的试次会导致很多试次被排除。幸运的是，这种伪迹基本上是非系统性的，它仅仅会降低整体信噪比。这种伪迹没什么好做的，也不是个严重的问题。